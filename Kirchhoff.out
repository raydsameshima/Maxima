       | E1            | E2
  *----||------*------||-----*
  |    |       |       |     |
  |            |             |
  \            \             \
  /            /             /
  \ R1         \ R2          \ R3
  /            /             /
  \            \             \
  |          ^ |             |
  |        I2| |             |
  *------------*-------------*
        I1 ->    -> I3

(%i25) print("for two loop circuit")
for two loop circuit 
(%o25)                       for two loop circuit
(%i26) solve([I1-I2-I3 = 0,(-E1)+I2*R2+I1*R1 = 0,E2+I3*R3+(-I2)*R2 = 0],[I1,I2,I3])
              E1 R3 + (E1 - E2) R2          E1 R3 + E2 R1
(%o26) [[I1 = --------------------, I2 = --------------------, 
              R2 (R3 + R1) + R1 R3       R2 (R3 + R1) + R1 R3
                                                         (E1 - E2) R2 - E2 R1
                                                    I3 = --------------------]]
                                                         R2 (R3 + R1) + R1 R3
  *------*------*------*
  |      |      |      |
  |      _E1    _E2    |
  |     ---    ---     |
  |      |      |      |
  |      |      |      |
  \      \      \      \
R1/    R2/    R3/    R4/
  \      \      \      \
  /      /|     /|     /
  |      |v I2  |v I3  |
  *------*------*------*
    <-I1  I2->   I4->
  
(%i27) print("for three loop circuit")
for three loop circuit 
(%o27)                      for three loop circuit
(%i28) solve([(-I1)+I2-I5,I3-I4+I5,E1-I2*R2+(-I1)*R1,E2-I3*R3+I2*R2-E1,
              (-E2)+I4*R4+I3*R3],[I1,I2,I3,I4,I5])
                      E1 R3 R4 + E2 R2 R4
(%o28) [[I1 = ------------------------------------, 
              R2 (R1 (R4 + R3) + R3 R4) + R1 R3 R4
     R1 (E1 (R4 + R3) - E2 R4) + E1 R3 R4
I2 = ------------------------------------, 
     R2 (R1 (R4 + R3) + R3 R4) + R1 R3 R4
     R1 (E2 R4 - E1 R4) + R2 (E2 R4 + E2 R1)
I3 = ---------------------------------------, 
      R2 (R1 (R4 + R3) + R3 R4) + R1 R3 R4
             E1 R1 R3 + E2 R1 R2
I4 = ------------------------------------, 
     R2 (R1 (R4 + R3) + R3 R4) + R1 R3 R4
       R1 (E2 R4 + E1 ((- R4) - R3)) + E2 R2 R4
I5 = - ----------------------------------------]]
         R2 (R1 (R4 + R3) + R3 R4) + R1 R3 R4
(%o28)                /Users/rdsAir/Desktop/Kirchhoff.mac
